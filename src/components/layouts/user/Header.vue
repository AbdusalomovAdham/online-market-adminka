<template>
  <div class="user-header">
    <div class="container">
      <div class="flex content-end gap-24">
        <router-link to="/user/profile" class="logo mr-auto">
          <!-- <p class="title">SMART-DM</p> -->
          <svg
            width="240"
            height="42"
            viewBox="0 0 240 42"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M28.7271 23.3289L41.2317 11.7966L41.3052 11.9065C41.3297 11.8821 41.4646 11.8699 41.7098 11.8699H45.1547C45.4979 11.8699 45.7921 11.9797 46.0373 12.1993C46.2886 12.419 46.4174 12.6997 46.4174 13.0414C46.4174 13.3678 46.2641 13.6638 45.9638 13.9322L45.5592 14.4082L35.2736 24.0245L46.5277 39.4619C46.7974 39.8036 46.8863 40.1179 46.7974 40.4016C46.7147 40.6884 46.54 40.9263 46.2703 41.1216C46.0404 41.268 45.8044 41.3413 45.5592 41.3413H42.4576C42.2369 41.3413 42.0346 41.3016 41.8569 41.2192C41.6853 41.1308 41.5136 40.9508 41.342 40.6823L41.3788 40.7555L31.608 27.3439C31.0932 27.832 30.6181 28.2805 30.186 28.6863C29.7508 29.0951 29.2665 29.5405 28.7271 30.0286V40.1575C28.7271 40.9477 28.3164 41.3413 27.5012 41.3413H25.0248C24.2555 41.3413 23.8724 40.9477 23.8724 40.1575L23.7988 13.0414C23.7988 12.2604 24.2065 11.8699 25.0248 11.8699H27.5012C28.3164 11.8699 28.7271 12.2604 28.7271 13.0414V23.3289Z"
              fill="#004D94"
            />
            <path
              d="M26.8358 11.8698C27.081 11.8698 27.3568 11.8911 27.6694 11.9308C27.979 11.9643 28.2579 12.0864 28.503 12.2969C28.7482 12.5013 28.8708 12.8765 28.8708 13.4196V40.2673C28.8708 40.8134 28.739 41.1307 28.4785 41.2191C28.2241 41.3015 27.9207 41.3412 27.5713 41.3412H25.3892C24.7517 41.3412 24.341 41.2557 24.1632 41.0849C23.9916 40.914 23.9058 40.5083 23.9058 39.8645V20.522C22.6216 22.1512 21.3558 23.7498 20.1054 25.318C18.861 26.8892 17.5738 28.4604 16.2437 30.0285L16.2804 29.9553C16.1088 30.2238 15.9494 30.3824 15.8023 30.4312C15.6552 30.4801 15.4468 30.5045 15.1771 30.5045H13.7305C13.3872 30.5045 13.1543 30.4679 13.0317 30.3946C12.9091 30.3214 12.7497 30.1628 12.5536 29.9187L4.96505 20.522V39.8645C4.96505 40.5083 4.8731 40.914 4.69534 41.0849C4.52371 41.2557 4.11915 41.3412 3.48166 41.3412H1.29949C0.956231 41.3656 0.665071 41.329 0.429078 41.2313C0.190021 41.1337 0.0735562 40.8378 0.0735562 40.3405L0 13.383C0 12.8643 0.134853 12.5013 0.404559 12.2969C0.680396 12.0864 0.993009 11.9643 1.33627 11.9308C1.67953 11.8911 1.94924 11.8698 2.14539 11.8698H3.48166C3.82492 11.8698 4.11302 11.9064 4.35208 11.9796C4.58807 12.0528 4.81793 12.2359 5.0386 12.5287L14.4783 24.3173L23.9426 12.4189C24.2429 12.0528 24.7272 11.8698 25.3892 11.8698H26.8358Z"
              fill="#004D94"
            />
            <mask
              id="mask0_100_106"
              style="mask-type: luminance"
              maskUnits="userSpaceOnUse"
              x="14"
              y="0"
              width="41"
              height="16"
            >
              <path d="M14.8828 0H54.0699V15.2299H14.8828V0Z" fill="white" />
            </mask>
            <g mask="url(#mask0_100_106)">
              <path
                d="M53.6937 4.72002L35.3843 0.158964C34.7683 0.00641968 34.1277 0.00641968 33.527 0.158964L15.2023 4.72002C14.8805 4.79629 14.8805 5.25697 15.2023 5.33324L24.2037 7.57563C29.3006 6.07155 34.7805 5.99528 39.9938 6.91359C34.7162 6.32782 29.1596 6.78546 24.2037 8.68615V11.2489C24.2037 11.4655 24.4091 11.6058 24.6144 11.5418C27.5322 10.6479 30.8882 10.1262 34.4495 10.1262C38.0078 10.1262 41.3638 10.6479 44.2969 11.5418C44.4991 11.6058 44.6922 11.4655 44.6922 11.2489V7.57563L48.6244 6.5963V13.4547H48.56C48.4191 13.4547 48.3026 13.5675 48.3026 13.7079V14.9709C48.3026 15.1113 48.4191 15.2242 48.56 15.2242H49.3293C49.4703 15.2242 49.5837 15.1113 49.5837 14.9709V13.7079C49.5837 13.5675 49.4703 13.4547 49.3293 13.4547H49.265V6.44376L53.6937 5.33324C54.0277 5.25697 54.0277 4.79934 53.6937 4.72002Z"
                fill="#018FC6"
              />
            </g>
            <path
              d="M77.0142 40.4256C77.0142 41.2066 76.6219 41.5971 75.8373 41.5971H73.2016C72.8154 41.5971 72.5549 41.5086 72.417 41.3286C72.2852 41.1425 72.1595 40.9137 72.0369 40.6452L68.7024 31.0655L59.704 35.0438L57.6935 40.6452C57.5709 40.9381 57.4483 41.17 57.3257 41.3408C57.2031 41.5117 56.9211 41.5971 56.4798 41.5971H53.9543C53.6663 41.5971 53.3935 41.4873 53.133 41.2676C52.8786 41.048 52.7529 40.7673 52.7529 40.4256C52.7529 40.4012 52.8663 40.0412 53.0962 39.3395C53.3322 38.6317 53.654 37.6798 54.0647 36.4839C54.4815 35.2818 54.9412 33.9272 55.45 32.4201C55.9649 30.916 56.5043 29.3509 57.0682 27.7218C57.6322 26.0956 58.1777 24.4939 58.711 22.9136C59.2504 21.3363 59.7469 19.8841 60.2066 18.5569C60.6725 17.2329 61.0679 16.1132 61.3958 15.201C61.7299 14.2918 61.9597 13.6939 62.0823 13.4071C62.2049 13.1386 62.3398 12.9159 62.4869 12.7359C62.634 12.5498 62.8914 12.4552 63.2592 12.4552H66.4712C66.839 12.4552 67.0872 12.5528 67.219 12.7481C67.3569 12.9433 67.4887 13.163 67.6113 13.4071L76.9775 39.9985C77.002 40.1693 77.0142 40.3127 77.0142 40.4256ZM66.9493 26.2207C66.7286 25.6441 66.5447 25.1682 66.3976 24.7929C66.2505 24.4116 66.1524 24.1217 66.1034 23.9265C66.0544 23.7312 65.9931 23.5451 65.9195 23.3651C65.8459 23.1882 65.7846 22.999 65.7356 22.8038C65.6191 22.4376 65.4935 22.0471 65.3556 21.6322C65.2238 21.2173 65.0613 20.7353 64.8652 20.18L61.8984 28.4418L66.9493 26.2207Z"
              fill="#004D94"
            />
            <path
              d="M91.4609 11.9795C93.4623 11.9795 95.2797 12.4005 96.9163 13.2365C98.5499 14.0754 99.9138 15.2348 101.011 16.7144C102.114 18.1972 102.856 19.8843 103.242 21.7789L103.205 22.145C103.138 22.3891 103.022 22.6301 102.85 22.865C102.678 23.0938 102.421 23.2067 102.078 23.2067H99.6257C99.3069 23.2067 99.0648 23.1335 98.9024 22.987C98.7461 22.8406 98.6081 22.6453 98.4855 22.4013C98.2955 21.8399 98.1178 21.3335 97.9461 20.8758C97.7745 20.4121 97.5293 19.9728 97.2106 19.5579C96.5486 18.664 95.718 17.9684 94.7219 17.4711C93.7228 16.9677 92.6378 16.7144 91.4609 16.7144C90.1676 16.7144 88.9784 17.0378 87.8935 17.6785C86.8054 18.3223 85.9381 19.1856 85.2945 20.2657C84.6478 21.3487 84.326 22.5447 84.326 23.8535V30.1993C84.326 31.5112 84.6478 32.7071 85.2945 33.7871C85.9381 34.8702 86.8054 35.7336 87.8935 36.3743C88.9784 37.018 90.1676 37.3383 91.4609 37.3383C92.6378 37.3383 93.7228 37.0821 94.7219 36.5695C95.718 36.057 96.5731 35.3431 97.2841 34.4217C97.6519 33.9336 97.9247 33.4424 98.1055 32.9451C98.2833 32.4508 98.4488 31.8956 98.5959 31.2854L98.5591 31.3586C98.6817 30.7088 99.0617 30.3823 99.6992 30.3823H102.151C102.494 30.3823 102.77 30.5044 102.985 30.7484C103.205 30.9864 103.316 31.2488 103.316 31.5417C103.316 31.9078 103.267 32.2922 103.169 32.6888C103.077 33.0885 102.972 33.4576 102.85 33.7993C102.31 35.3553 101.452 36.7526 100.275 37.9973C99.1046 39.236 97.7561 40.2122 96.2298 40.9262C94.7097 41.6401 93.119 42.0001 91.4609 42.0001C89.8243 42.0001 88.2888 41.698 86.8514 41.097C85.4109 40.4868 84.1482 39.6417 83.0633 38.5587C81.9752 37.4787 81.1201 36.2217 80.501 34.7878C79.8789 33.3569 79.5693 31.8285 79.5693 30.1993V23.8535C79.5693 22.2274 79.8789 20.6989 80.501 19.265C81.1201 17.8341 81.9752 16.5741 83.0633 15.4819C84.1482 14.3836 85.4109 13.5263 86.8514 12.907C88.2888 12.2907 89.8243 11.9795 91.4609 11.9795Z"
              fill="#004D94"
            />
            <path
              d="M129.854 40.4256C129.854 41.2066 129.462 41.5971 128.677 41.5971H126.041C125.655 41.5971 125.395 41.5086 125.257 41.3286C125.125 41.1425 124.999 40.9137 124.877 40.6452L121.542 31.0655L112.544 35.0438L110.533 40.6452C110.411 40.9381 110.288 41.17 110.166 41.3408C110.043 41.5117 109.761 41.5971 109.32 41.5971H106.794C106.506 41.5971 106.233 41.4873 105.973 41.2676C105.718 41.048 105.593 40.7673 105.593 40.4256C105.593 40.4012 105.706 40.0412 105.936 39.3395C106.172 38.6317 106.494 37.6798 106.905 36.4839C107.321 35.2818 107.781 33.9272 108.29 32.4201C108.805 30.916 109.344 29.3509 109.908 27.7218C110.472 26.0956 111.018 24.4939 111.551 22.9136C112.09 21.3363 112.587 19.8841 113.046 18.5569C113.512 17.2329 113.908 16.1132 114.236 15.201C114.57 14.2918 114.8 13.6939 114.922 13.4071C115.045 13.1386 115.18 12.9159 115.327 12.7359C115.474 12.5498 115.731 12.4552 116.099 12.4552H119.311C119.679 12.4552 119.927 12.5528 120.059 12.7481C120.197 12.9433 120.329 13.163 120.451 13.4071L129.817 39.9985C129.842 40.1693 129.854 40.3127 129.854 40.4256ZM119.789 26.2207C119.568 25.6441 119.385 25.1682 119.237 24.7929C119.09 24.4116 118.992 24.1217 118.943 23.9265C118.894 23.7312 118.833 23.5451 118.759 23.3651C118.686 23.1882 118.624 22.999 118.575 22.8038C118.459 22.4376 118.333 22.0471 118.195 21.6322C118.064 21.2173 117.901 20.7353 117.705 20.18L114.738 28.4418L119.789 26.2207Z"
              fill="#004D94"
            />
            <path
              d="M144.045 12.4552C145.654 12.4552 147.162 12.7603 148.568 13.3705C149.972 13.9745 151.204 14.8044 152.258 15.86C153.319 16.9186 154.159 18.1481 154.772 19.5454C155.385 20.9366 155.691 22.4224 155.691 23.9997V30.0526C155.691 31.633 155.385 33.1218 154.772 34.5191C154.159 35.9103 153.319 37.1367 152.258 38.1923C151.204 39.251 149.972 40.0839 148.568 40.6941C147.162 41.2981 145.654 41.5971 144.045 41.5971H133.698C133.354 41.5971 133.072 41.4873 132.852 41.2676C132.631 41.048 132.521 40.7673 132.521 40.4256L132.447 13.6267C132.447 13.3339 132.57 13.0654 132.815 12.8213C133.06 12.5772 133.354 12.4552 133.698 12.4552H144.045ZM137.351 17.3V36.7523H144.045C145.295 36.7523 146.429 36.4533 147.453 35.8493C148.473 35.2391 149.292 34.4276 149.905 33.4086C150.518 32.3835 150.824 31.2669 150.824 30.0526V23.9997C150.824 22.7885 150.518 21.6749 149.905 20.6559C149.292 19.6308 148.473 18.8193 147.453 18.2152C146.429 17.6051 145.295 17.3 144.045 17.3H137.351Z"
              fill="#004D94"
            />
            <path
              d="M161.034 41.5971C160.69 41.5971 160.408 41.4873 160.188 41.2676C159.967 41.048 159.857 40.7673 159.857 40.4256L159.783 13.6267C159.783 13.285 159.906 13.0044 160.151 12.7847C160.396 12.565 160.69 12.4552 161.034 12.4552H178.699C179.312 12.4552 179.668 12.6016 179.766 12.8945C179.864 13.1874 179.913 13.5139 179.913 13.8708V15.8844C179.913 16.5373 179.827 16.9339 179.656 17.0803C179.484 17.2268 179.079 17.3 178.442 17.3H164.724V23.7434H176.91C177.253 23.7434 177.535 23.8624 177.755 24.0973C177.976 24.3261 178.086 24.6099 178.086 24.9516V27.4289C178.086 27.7706 177.976 28.0574 177.755 28.2831C177.535 28.5119 177.253 28.6248 176.91 28.6248H164.724V36.7523H178.92C179.558 36.7523 179.962 36.8256 180.134 36.972C180.305 37.1184 180.391 37.5181 180.391 38.1679V40.1449C180.391 40.5049 180.342 40.8375 180.244 41.1456C180.146 41.4476 179.791 41.5971 179.178 41.5971H161.034Z"
              fill="#004D94"
            />
            <path
              d="M210.646 12.4552C210.892 12.4552 211.164 12.4766 211.468 12.5162C211.777 12.5498 212.05 12.6718 212.289 12.8823C212.534 13.0867 212.657 13.4528 212.657 13.9806V40.5354C212.657 41.0724 212.528 41.3866 212.277 41.4751C212.023 41.5575 211.725 41.5971 211.382 41.5971H209.224C208.587 41.5971 208.182 41.5117 208.011 41.3408C207.839 41.17 207.753 40.7734 207.753 40.1449V21.0098C206.484 22.6146 205.234 24.195 204.002 25.757C202.776 27.3129 201.504 28.8658 200.189 30.4187L200.226 30.3455C200.054 30.6079 199.895 30.7604 199.748 30.8092C199.601 30.8581 199.392 30.8825 199.123 30.8825H197.701C197.357 30.8825 197.124 30.8459 197.002 30.7726C196.879 30.6994 196.72 30.5469 196.524 30.3089L189.021 21.0098V40.1449C189.021 40.7734 188.935 41.17 188.763 41.3408C188.592 41.5117 188.19 41.5971 187.562 41.5971H185.404C185.061 41.6215 184.77 41.5849 184.534 41.4873C184.304 41.3897 184.191 41.0968 184.191 40.6086L184.117 13.944C184.117 13.4406 184.252 13.0867 184.522 12.8823C184.791 12.6718 185.092 12.5498 185.429 12.5162C185.772 12.4766 186.042 12.4552 186.238 12.4552H187.562C187.896 12.4552 188.178 12.4918 188.408 12.565C188.644 12.6383 188.874 12.8213 189.094 13.1142L198.424 24.7685L207.79 13.0044C208.084 12.6383 208.562 12.4552 209.224 12.4552H210.646Z"
              fill="#004D94"
            />
            <path
              d="M234.545 12.9311C234.79 12.6138 235.121 12.4552 235.538 12.4552H238.824C239.608 12.4552 240.001 12.8457 240.001 13.6267C240.001 13.8159 239.951 13.9928 239.853 14.1637C239.755 14.3345 239.657 14.481 239.559 14.603C239.559 14.6274 239.55 14.6396 239.535 14.6396C239.525 14.6396 239.522 14.6518 239.522 14.6762L239.486 14.7128L230.083 28.0879V40.1815C230.083 40.5415 230.034 40.8649 229.936 41.1578C229.837 41.4507 229.482 41.5971 228.869 41.5971H226.38C225.823 41.5971 225.488 41.4507 225.375 41.1578C225.268 40.8649 225.216 40.5415 225.216 40.1815V28.0146L215.555 14.2735C215.482 14.1515 215.436 14.0417 215.42 13.944C215.411 13.8464 215.408 13.7305 215.408 13.5901C215.408 12.8335 215.782 12.4552 216.536 12.4552H219.797C220.263 12.4552 220.618 12.6383 220.864 13.0044L227.704 23.0966C229.608 20.177 231.131 17.8705 232.277 16.1773C233.42 14.4779 234.202 13.3705 234.619 12.8579L234.545 12.9311Z"
              fill="#004D94"
            />
          </svg>
        </router-link>
        <div @click="profileModal = true" class="user-data">
          <div class="avatar">
            <img v-if="avatar" :src="avatar" />
            <span v-else>U</span>
          </div>
          <span class="username">User 1</span>
        </div>
      </div>
    </div>
  </div>
  <g-modal @close="profileModal = false" v-if="profileModal">
    <template v-slot:body>
      <div class="rows gap-18 mb-24">
        <div class="col-24 flex center mb-18">
          <Avatar :uploadable="false"></Avatar>
        </div>
        <div class="col-12">
          <Text title="F.I.O" :text="authStore.me?.full_name"></Text>
        </div>
        <div class="col-12">
          <Text title="Telefon raqam" :text="authStore.me?.phone"></Text>
        </div>
        <div class="col-12">
          <Text title="Email" :text="authStore.me?.email"></Text>
        </div>
      </div>
      <button @click="logoutConfirm = true" class="logout-btn ml-auto">
        <span>Chiqish</span>
        <IconSignOut></IconSignOut>
      </button>
    </template>
  </g-modal>
  <ConfirmModal
    v-if="logoutConfirm"
    title="Akkaunt chiqishni tasdiqlaysizmi?"
    @confirm="logout"
    @cancel="logoutConfirm = false"
  ></ConfirmModal>
</template>

<script setup>
import Avatar from "@/components/g/Avatar.vue";
import IconSignOut from "@/components/icon/SignOut.vue";
import ConfirmModal from "@/components/g/ConfirmModal.vue";
import { onMounted, ref } from "vue";
import { useRouter } from "vue-router";
import GModal from "@/components/g/Modal.vue";
import Text from "@/components/g/Text.vue";
import { useAuthSignIn } from "@/store/auth/sign-in";

const authStore = useAuthSignIn();
const router = useRouter();
const logoutConfirm = ref(false);
const profileModal = ref(false);
const avatar = ref(null);

onMounted(() => {
  const me = localStorage.getItem("me");

  authStore.setMe(JSON.parse(me));
});

const logout = () => {
  localStorage.removeItem("token");
  localStorage.removeItem("role");
  localStorage.removeItem("me");
  window.location.href = "https://smart-dm.uz";
  // router.push('/auth/sign-in')
};
</script>
